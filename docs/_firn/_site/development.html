<html><head><meta charset="utf-8" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><meta content="" name="author" /><meta content="" name="description" /><title></title><link href="http://localhost:4000/static/css/firn_base.css" rel="stylesheet" /></head><body><main class="def-wrapper"><aside class="def-sidebar unfocused" id="sidebar"><ul class="firn-sitemap firn-sitemap-item--parent"><li><a class="firn-sitemap-item--link" href="http://localhost:4000/index">Home</a></li><li><a class="firn-sitemap-item--link" href="http://localhost:4000/contributing">Contibuting</a></li><li><a class="firn-sitemap-item--link" href="http://localhost:4000/community">Community</a></li><li><a class="firn-sitemap-item--link" href="http://localhost:4000/api">API</a></li><li><a class="firn-sitemap-item--link" href="http://localhost:4000/roadmap">Roadmap</a></li><li><a class="firn-sitemap-item--link" href="http://localhost:4000/configuration">Configuring FlatTrack</a></li><li><a class="firn-sitemap-item--link" href="http://localhost:4000/meta">Meta</a></li><li><a class="firn-sitemap-item--link" href="http://localhost:4000/testing">Testing</a></li><li><a class="firn-sitemap-item--link" href="http://localhost:4000/development">FlatTrack development</a></li><li><a class="firn-sitemap-item--link" href="http://localhost:4000/design-guidelines">Design guidelines</a></li><li><a class="firn-sitemap-item--link" href="http://localhost:4000/deployment">Deploying FlatTrack</a></li></ul></aside><article class="content"><div><div><section></section><div class="firn-headline-section firn-headline-section-1"><h1 class="firn-headline firn-headline-1" id="development-cycle"><span class="firn-headline-text"><span>Development cycle</span></span></h1><section><p><span>In-cluster local development is recommended, use </span><a class="firn-external" href="https://minikube.sigs.k8s.io" target="_blank">minikube</a><span> or </span><a class="firn-external" href="https://kind.sigs.k8s.io/" target="_blank">kind</a><span>.</span></p></section><div class="firn-headline-section firn-headline-section-2"><h2 class="firn-headline firn-headline-2" id="(almost)-automatic"><span class="firn-headline-text"><span>(almost) Automatic</span></span></h2><section><p><span>Get tilt from </span><a class="firn-external" href="https://tilt.dev" target="_blank">Tilt.dev</a><span>.</span></p><pre class="language-shell"><code class="language-shell">tilt up --host 0.0.0.0
</code></pre><p><span>Build the backend:</span></p><pre class="language-shell"><code class="language-shell">CGO_ENABLED=0 go build -a -installsuffix cgo -ldflags "-extldflags '-static' -s -w" -o flattrack ./main.go
</code></pre><p><span>Build the frontend:</span></p><pre class="language-shell"><code class="language-shell">npm run build
</code></pre><p><span>Notes:</span></p><ul><li><p><span>this is the quickest development cycle factoring:</span></p><ul><li><p><span>multi-stage build</span></p></li><li><p><span>components</span></p></li><li><p><span>setup</span></p></li></ul></li></ul></section></div><div class="firn-headline-section firn-headline-section-2"><h2 class="firn-headline firn-headline-2" id="manual"><span class="firn-headline-text"><span>Manual</span></span></h2><div class="firn-headline-section firn-headline-section-3"><h3 class="firn-headline firn-headline-3" id="bring-up-the-deployments"><span class="firn-headline-text"><span>Bring up the deployments</span></span></h3><section><pre class="language-shell"><code class="language-shell">   kubectl apply -k deployments/k8s-manifests/development/postgres
</code></pre></section></div><div class="firn-headline-section firn-headline-section-3"><h3 class="firn-headline firn-headline-3" id="port-forward-the-database-connection"><span class="firn-headline-text"><span>Port-forward the database connection</span></span></h3><section><pre class="language-shell"><code class="language-shell">   kubectl -n flattrack-dev port-forward service/postgres 5432:5432
</code></pre></section></div><div class="firn-headline-section firn-headline-section-3"><h3 class="firn-headline firn-headline-3" id="backend"><span class="firn-headline-text"><span>Backend</span></span></h3><section><pre class="language-shell"><code class="language-shell">    go build -o flattrack ./main.go && ./flattrack
</code></pre></section></div><div class="firn-headline-section firn-headline-section-3"><h3 class="firn-headline firn-headline-3" id="frontend"><span class="firn-headline-text"><span>Frontend</span></span></h3><section><p><span>Install frontend dependencies:</span></p><pre class="language-shell"><code class="language-shell">    npm i
</code></pre><p><span>Build the frontend:</span></p><pre class="language-shell"><code class="language-shell">    npm run build
</code></pre></section></div></div></div><div class="firn-headline-section firn-headline-section-1"><h1 class="firn-headline firn-headline-1" id="additional"><span class="firn-headline-text"><span>Additional</span></span></h1><div class="firn-headline-section firn-headline-section-3"><h3 class="firn-headline firn-headline-3" id="manually-connecting-to-the-postgres-database"><span class="firn-headline-text"><span>Manually connecting to the Postgres database</span></span></h3><section><pre class="language-shell"><code class="language-shell">   kubectl -n flattrack-dev exec -it postgres-0 -- psql
</code></pre></section></div><div class="firn-headline-section firn-headline-section-3"><h3 class="firn-headline firn-headline-3" id="remove-migrations"><span class="firn-headline-text"><span>Remove migrations</span></span></h3><section><pre class="language-shell"><code class="language-shell">   gomigrate -source "file://$(pwd)/migrations" -database postgres://flattrack:flattrack@localhost/flattrack?sslmode=disable down
</code></pre></section></div></div><div class="firn-headline-section firn-headline-section-1"><h1 class="firn-headline firn-headline-1" id="project-structure-and-details"><span class="firn-headline-text"><span>Project structure and details</span></span></h1><div class="firn-headline-section firn-headline-section-3"><h3 class="firn-headline firn-headline-3" id="code"><span class="firn-headline-text"><span>Code</span></span></h3></div><div class="firn-headline-section firn-headline-section-3"><h3 class="firn-headline firn-headline-3" id="api"><span class="firn-headline-text"><span>API</span></span></h3><section><p><span>Written in golang, the API is located in </span><a class="firn-external" href="https://gitlab.com/flattrack/flattrack/-/tree/master/pkg/routes" target="_blank">pkg/routes</a><span>.</span></p><p><span>The features and areas are separated into packages.</span></p></section><div class="firn-headline-section firn-headline-section-4"><h4 class="firn-headline firn-headline-4" id="testing"><span class="firn-headline-text"><span>Testing</span></span></h4><section><p><span>Tests are located in </span><a class="firn-external" href="https://gitlab.com/flattrack/flattrack/-/tree/master/test/backend/e2e" target="_blank">test/backend/e2e</a><span>. So far there are only e2e tests for FlatTrack's API.</span></p></section></div></div><div class="firn-headline-section firn-headline-section-3"><h3 class="firn-headline firn-headline-3" id="frontend"><span class="firn-headline-text"><span>Frontend</span></span></h3><section><p><span>Written in Vue.js + JavaScript, the frontend is located in </span><a class="firn-external" href="https://gitlab.com/flattrack/flattrack/-/tree/master/test/frontend" target="_blank">web</a><span>.</span></p><p><span>The frontend makes requests to the backend to perform actions.</span></p></section></div><div class="firn-headline-section firn-headline-section-3"><h3 class="firn-headline firn-headline-3" id="database"><span class="firn-headline-text"><span>Database</span></span></h3><section><p><span>The migrations and database structuring is located in </span><a class="firn-external" href="https://gitlab.com/flattrack/flattrack/-/tree/master/migrations" target="_blank">migrations</a><span>.
Each table is created with </span><a class="firn-external" href="https://github.com/golang-migrate/migrate" target="_blank">golang-migrate</a><span>.</span></p></section></div><div class="firn-headline-section firn-headline-section-3"><h3 class="firn-headline firn-headline-3" id="assets"><span class="firn-headline-text"><span>Assets</span></span></h3><section><p><span>Images are located in </span><a class="firn-external" href="https://gitlab.com/flattrack/flattrack/-/tree/master/web/assets" target="_blank">web/assets</a><span>, these are used throughout the project (such as in the frontend, and readme).</span></p></section></div></div><div class="firn-headline-section firn-headline-section-1"><h1 class="firn-headline firn-headline-1" id="docs"><span class="firn-headline-text"><span>Docs</span></span></h1><section><p><span>To run the docs in development, use:</span></p><pre class="language-sh"><code class="language-sh">docker run --rm -it -p 8000:8000 -v ${PWD}:/docs:ro,Z squidfunk/mkdocs-material
</code></pre></section></div><div class="firn-headline-section firn-headline-section-1"><h1 class="firn-headline firn-headline-1" id="making-a-release-checklist"><span class="firn-headline-text"><span>Making a release checklist</span></span></h1><section><p><span>Things to do before making a release:</span></p><ul><li><p><span>update helm chart version</span></p></li><li><p><span>ensure docs represent the latest changes</span></p></li><li><p><span>ensure linting passes</span></p></li></ul></section></div></div></div></article></main></body></html>